profiles {
    singularity {
        singularity.enabled    = true
        singularity.autoMounts  = true
        singularity.cacheDir    = "${HOME}/singularity_cache"
    }
}

process {
    executor       = 'slurm'
    clusterOptions = '-q primary'
    container      = 'docker://go2432/xengsort:latest' // Default for all processes

    withName: 'INDEX' {
        cpus   = 16
        memory = '80 GB'
        time   = '24h'
    }
    withName: 'SORT_READS' {
        cpus   = 8
        memory = '32 GB'
        time   = '12h'
    }
    withName: 'MULTIQC' {
        container = 'docker://multiqc/multiqc:v1.33' // Overrides xengsort for this step
        cpus   = 2
        memory = '4 GB'
        time   = '1h'
    }
}
